<map version="1.0.1"><node CREATED="1620678336248" ID="ID_root" MODIFIED="1620678336248" TEXT="应用时间序列分析"><node CREATED="1620678336248" ID="ID_4a297463bd8a" POSITION="right" MODIFIED="1620678336248" TEXT="0. 例子作为引子：类比C采集到的EEG信号中的&amp;nbsp;漂移项、EEG信号、噪音"><node CREATED="1620678336248" ID="ID_2393db64dc21" MODIFIED="1620678336248" TEXT="a. 分段趋势"></node><node CREATED="1620678336248" ID="ID_1447879398fc" MODIFIED="1620678336248" TEXT="b. 回归直线趋势"></node><node CREATED="1620678336248" ID="ID_5b4734ffb683" MODIFIED="1620678336248" TEXT="c. 二次曲线趋势"></node><node CREATED="1620678336248" ID="ID_91e94a064a86" MODIFIED="1620678336248" TEXT="d. 逐步平均法&amp;nbsp;"></node><node CREATED="1620678336248" ID="ID_f1127920b60f" MODIFIED="1620678336248" TEXT="&amp;lt;b&amp;gt;e. 全回归方法&amp;lt;/b&amp;gt;"></node></node><node CREATED="1620678336248" ID="ID_318310671072" POSITION="right" MODIFIED="1620678336248" TEXT="1. 线性平稳序列和线性滤波"><node CREATED="1620678336248" ID="ID_029344813c50" MODIFIED="1620678336248" TEXT="线性平稳序列是白噪声的线性组合得到的序列。&amp;nbsp;最简单的线性平稳序列是有限运动平均。"></node><node CREATED="1620678336248" ID="ID_c2954239565c" MODIFIED="1620678336248" TEXT="收敛性"><node CREATED="1620678336248" ID="ID_df4eabab4952" MODIFIED="1620678336248" TEXT="马尔可夫不等式"></node><node CREATED="1620678336248" ID="ID_911d353cb209" MODIFIED="1620678336248" TEXT="切比雪夫不等式"></node><node CREATED="1620678336248" ID="ID_5b04d5256c0c" MODIFIED="1620678336248" TEXT="Schwarz 柯西不等式"></node><node CREATED="1620678336248" ID="ID_41024b52e428" MODIFIED="1620678336248" TEXT="Cauchy不等式"></node><node CREATED="1620678336248" ID="ID_b3c6df943748" MODIFIED="1620678336248"></node><node CREATED="1620678336248" ID="ID_e0d1d3c7ed48" MODIFIED="1620678336248"></node><node CREATED="1620678336248" ID="ID_88e1f75c3027" MODIFIED="1620678336248" TEXT="完备的内积空间： Hilbert 空间"></node></node><node CREATED="1620678336248" ID="ID_700029e8f579" MODIFIED="1620678336248" TEXT="线性滤波"><node CREATED="1620678336248" ID="ID_82c459adae1d" MODIFIED="1620678336248" TEXT="moving average： 矩形窗滤波器，抑制高频信号"></node></node></node><node CREATED="1620678336248" ID="ID_5449286950e3" POSITION="right" MODIFIED="1620678336248" TEXT="2. 严平稳序列和其遍历性"><node CREATED="1620678336248" ID="ID_902b18e9cd0e" MODIFIED="1620678336248"></node><node CREATED="1620678336248" ID="ID_7dc9bcd63701" MODIFIED="1620678336248" TEXT="遍历性可以保证从一条轨道可以推断整体的统计性质。"></node></node><node CREATED="1620678336248" ID="ID_17f2333470e2" POSITION="right" MODIFIED="1620678336248" TEXT="3. AR序列"><node CREATED="1620678336248" ID="ID_05a5ae61880c" MODIFIED="1620678336248" TEXT="谱密度、功率谱密度：每赫兹的功率、每赫兹的能量这样的物理量纲。"></node><node CREATED="1620678336249" ID="ID_a017e8e72b73" MODIFIED="1620678336249" TEXT="Yule-Walker方程：描述自回归序列参数与其协方差函数之间关系的方程。&amp;nbsp;在统计和信号处理中，尤尔—沃克方程与自回归模型关系密切，是一种随机过程的表示，它用于描述自然界，经济学等中的某些时变过程。&amp;lt;br&amp;gt;自相关系数的估计，包括&amp;quot;yule-walker&amp;quot;,&amp;nbsp;&amp;quot;burg&amp;quot;,&amp;nbsp;&amp;quot;ols&amp;quot;,&amp;nbsp;&amp;quot;mle&amp;quot;,&amp;nbsp;&amp;quot;yw&amp;quot;，默认是用yule-walker方法，常用的方法还有最小二乘法(ols)，极大似然法(mle)。&amp;lt;br&amp;gt;"></node><node CREATED="1620678336249" ID="ID_6c092dde6f3f" MODIFIED="1620678336249" TEXT="自回归模型的平稳性，wold系数"></node><node CREATED="1620678336249" ID="ID_07d4da6c6b40" MODIFIED="1620678336249" TEXT="必须具有平稳性，平稳性要求随机过程的随机特征不随时间变化。&amp;lt;br&amp;gt;必须具有自相关性，如果自相关系数(φi)小于0.5，则不宜采用，否则预测结果极不准确。&amp;lt;br&amp;gt;自回归只适用于预测与自身前期相关的现象，即受自身历史因素影响较大的现象。对于受其他因素影响的现象，不宜采用自回归，可以改用向量自回归模型。"></node><node CREATED="1620678336249" ID="ID_4da8e42a1c4c" MODIFIED="1620678336249" TEXT="多重共线性是指线性回归模型中的解释变量之间由于存在精确相关关系或高度相关关系而使模型估计失真或难以估计准确。&amp;nbsp;一般来说，由于经济数据的限制使得模型设计不当，导致设计矩阵中解释变量间存在普遍的相关关系。"></node><node CREATED="1620678336249" ID="ID_9c22a610af89" MODIFIED="1620678336249" TEXT="参数评估方法： 信息准则 AIC/BIC, 预测均方误差，多步预测的半衰期"></node><node CREATED="1620678336249" ID="ID_8f82b2c52598" MODIFIED="1620678336249" TEXT="AR仅通过时间序列变量的自身历史观测值来反映有关因素对预测目标的影响和作用，不受模型变量相互独立的假设条件约束，所构成的模型可以消除普通回归预测方法中由于自变量选择、多重共线性等造成的困难。"></node><node CREATED="1620678336249" ID="ID_c44a4b2b4f54" MODIFIED="1620678336249"></node></node><node CREATED="1620678336249" ID="ID_4839fa12d875" POSITION="right" MODIFIED="1620678336249" TEXT="分支主题"><node CREATED="1620678336249" ID="ID_110c9b901ca2" MODIFIED="1620678336249" TEXT="0. 随机性检测等"></node><node CREATED="1620678336249" ID="ID_4064762071c5" MODIFIED="1620678336249" TEXT="1. 平稳性检验"><node CREATED="1620678336249" ID="ID_df4b8f210bd8" MODIFIED="1620678336249" TEXT="自相关性"><node CREATED="1620678336249" ID="ID_c571082694dd" MODIFIED="1620678336249" TEXT="wold定理"><node CREATED="1620678336249" ID="ID_6063adb9dfc5" MODIFIED="1620678336249" TEXT="Wold分解定理，任意一个离散平稳时间序列都可以分解为一个确定性平稳序列和一个随机性平稳序列之和。"></node></node><node CREATED="1620678336249" ID="ID_0827b434d311" MODIFIED="1620678336249" TEXT="ACF"></node></node><node CREATED="1620678336249" ID="ID_9c4f4f17e23e" MODIFIED="1620678336249" TEXT="偏自相关性"></node><node CREATED="1620678336249" ID="ID_961477e41612" MODIFIED="1620678336249" TEXT="单位根检验"><node CREATED="1620678336249" ID="ID_c8ffb3d68d73" MODIFIED="1620678336249" TEXT="当一个时间序列的滞后算子多项式方程存在单位根时，我们认为该时间序列是非平稳的；反之，当该方程不存在单位根时，我们认为该时间序列是平稳的。"></node></node></node><node CREATED="1620678336249" ID="ID_656e0df92c4f" MODIFIED="1620678336249" TEXT="2. 白噪声"><node CREATED="1620678336249" ID="ID_4f6a5f8c78b6" MODIFIED="1620678336249" TEXT="chi-square"><node CREATED="1620678336249" ID="ID_10547ad8eb67" MODIFIED="1620678336249" TEXT="独立同分布的白噪声，尽似 chi-square分布"></node><node CREATED="1620678336249" ID="ID_7aefd420e1ad" MODIFIED="1620678336249" TEXT="Box-Pierce检验"></node><node CREATED="1620678336249" ID="ID_33de306f935e" MODIFIED="1620678336249" TEXT="Ljung-Box检验"></node></node><node CREATED="1620678336249" ID="ID_e6de25ef668f" MODIFIED="1620678336249" TEXT="样本自相关置信区间检验法"></node></node><node CREATED="1620678336249" ID="ID_b13039586ec1" MODIFIED="1620678336249" TEXT="3. 模型识别"><node CREATED="1620678336249" ID="ID_fe2fa2aa5216" MODIFIED="1620678336249" TEXT="一系列平稳或者非平稳的参数模型——ARIMA(p,d,q)模型"></node><node CREATED="1620678336249" ID="ID_d9d9575751e8" MODIFIED="1620678336249" TEXT="为模型定阶，也就是选择恰当的 p,d,q"><node CREATED="1620678336249" ID="ID_148e0ea285f3" MODIFIED="1620678336249" TEXT="information criteria"><node CREATED="1620678336249" ID="ID_db14b067650a" MODIFIED="1620678336249" TEXT="对于ARMA(p,q)，若有截距项，则k=p+q+1；若没有截距项，k=p+q&amp;lt;br&amp;gt;一般用R直接算不同p,q下模型的AIC，然后选择最小AIC的模型&amp;lt;br&amp;gt;应用中最常使用"></node></node></node></node><node CREATED="1620678336249" ID="ID_046f30564261" MODIFIED="1620678336249" TEXT="4. 参数估计"><node CREATED="1620678336249" ID="ID_22de890c892b" MODIFIED="1620678336249" TEXT="矩估计(MME)"><node CREATED="1620678336249" ID="ID_5356b8f58f05" MODIFIED="1620678336249" TEXT="样本矩去估计总体矩"><node CREATED="1620678336249" ID="ID_d80ef9415e21" MODIFIED="1620678336249" TEXT="AR: Yule-walker&amp;nbsp;equation"></node></node></node><node CREATED="1620678336249" ID="ID_19d93562dfd1" MODIFIED="1620678336249" TEXT="极大似然估计 MLE"></node><node CREATED="1620678336249" ID="ID_58c2d7000526" MODIFIED="1620678336249" TEXT="条件最小二乘(CLS)"></node><node CREATED="1620678336249" ID="ID_6b1d5242bfba" MODIFIED="1620678336249" TEXT="无条件最小二乘(ULS)"></node></node><node CREATED="1620678336249" ID="ID_6ca3ff53838c" MODIFIED="1620678336249" TEXT="5. 模型优化"><node CREATED="1620678336249" ID="ID_d516278df4ba" MODIFIED="1620678336249" TEXT="自回归/滑动平均阶数判断"><node CREATED="1620678336249" ID="ID_3357fb7937d5" MODIFIED="1620678336249" TEXT="差分方法可消除正相关但同时引入负相关&amp;lt;br&amp;gt;AR项可消除正相关，MA项消除负相关&amp;lt;br&amp;gt;AR项和MA项作用会相互抵消，通常包含两种要素时可尝试减少某项，避免过拟合"></node></node><node CREATED="1620678336249" ID="ID_43ed6342acb2" MODIFIED="1620678336249" TEXT="FACEBOOK的时间序列开源算法"><node CREATED="1620678336249" ID="ID_2efa435431e6" MODIFIED="1620678336249" TEXT="fbprophet"></node></node></node><node CREATED="1620678336249" ID="ID_4d9f623750f9" MODIFIED="1620678336249" TEXT="6. 序列预测"></node></node><node CREATED="1620678336249" ID="ID_554ba6146aa8" POSITION="right" MODIFIED="1620678336249" TEXT="4. 时间序列的谱"><node CREATED="1620678336249" ID="ID_57571016ce22" MODIFIED="1620678336249" TEXT="求功率谱密度均为先求自相关函数，然后进行傅里叶变换求得。功率谱密度即自相关函数的傅里叶变换。当波的功率频谱密度乘以一个适当的系数后将得到每单位频率波携带的功率，这被称为信号的功率谱密度（power&amp;nbsp;spectral&amp;nbsp;density,&amp;nbsp;PSD）；不要和&amp;nbsp;spectral&amp;nbsp;power&amp;nbsp;distribution（SPD）&amp;nbsp;混淆。"></node></node><node CREATED="1620678336249" ID="ID_aaa3f4c1f64e" POSITION="right" MODIFIED="1620678336249" TEXT="5. 自回归滑动平均模型ARMA"><node CREATED="1620678336249" ID="ID_79175a3eef39" MODIFIED="1620678336249" TEXT="AR模型是通过分析研究历史数据对当前数据的影响进行建模。&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;MA模型是用过去各个时期的随机干扰或预测误差的线性组合来表达当前预测值。在EEG信号分析中，主要是为了降噪和滤波FIR低通滤波器。&amp;lt;br&amp;gt;两处应用的滑动平均概念是一个滑动平均，但不是一个对象。&amp;nbsp;EEG里面平均的是过去的自己。金融时间序列里的是过去的残差：&amp;nbsp;用过去各个时期的随机干扰或预测误差的线性组合来表达当前预测值。"></node><node CREATED="1620678336249" ID="ID_e80b96fbf401" MODIFIED="1620678336249"></node></node><node CREATED="1620678336249" ID="ID_6e685e010b59" POSITION="right" MODIFIED="1620678336249" TEXT="6. 异方差模型：自回归差分滑动平均模型ARIMA"><node CREATED="1620678336249" ID="ID_133136258526" MODIFIED="1620678336249" TEXT="将自回归模型（AR）、移动平均模型（MA）和差分法结合，我们就得到了差分自回归移动平均模型&amp;nbsp;ARIMA（p、d、q），其中&amp;nbsp;d&amp;nbsp;是需要对数据进行差分的阶数。ARIMA&amp;nbsp;模型是通过寻找历史数据之间的自相关性，来预测未来（假设未来将重复历史的走势），要求序列必须是平稳的。ARIMA(p,&amp;nbsp;d,&amp;nbsp;q)模型是对&amp;nbsp;ARMA(p,&amp;nbsp;q)模型的扩展。它通过&amp;nbsp;d&amp;nbsp;阶差分将非平稳时间序列转化为平稳时间序列，然后再建立ARMA(p,&amp;nbsp;q)模型"></node><node CREATED="1620678336249" ID="ID_80f693c21ce1" MODIFIED="1620678336249" TEXT="对序列绘图，进行&amp;nbsp;ADF&amp;nbsp;检验，观察序列是否平稳；对于非平稳时间序列要先进行&amp;nbsp;d&amp;nbsp;阶差分，转化为平稳时间序列；&amp;lt;br&amp;gt;经过第一步处理，已经得到平稳时间序列。要对平稳时间序列分别求得其自相关系数（ACF）和偏自相关系数（PACF），通过对自相关图和偏自相关图的分析，得到最佳的阶数p、q；&amp;lt;br&amp;gt;由以上得到的d、q、p&amp;nbsp;，得到&amp;nbsp;ARIMA&amp;nbsp;模型。然后开始对得到的模型进行模型检验。&amp;lt;br&amp;gt;拟合序列&amp;nbsp;=&amp;nbsp;周期序列&amp;nbsp;+&amp;nbsp;趋势序列（ARIMA拟合）&amp;nbsp;+&amp;nbsp;残差序列（ARIMA拟合）&amp;lt;br&amp;gt;"></node><node CREATED="1620678336249" ID="ID_c57e97230ecf" MODIFIED="1620678336249" TEXT="在参数选择的时候，需要平衡预测误差与模型复杂度。我们可以根据信息准则函数法，来确定模型的阶数。AIC&amp;nbsp;准则存在一定的不足。当样本容量很大时，在&amp;nbsp;AIC&amp;nbsp;准则中拟合误差提供的信息就要受到样本容量的放大，而参数个数的惩罚因子却和样本容量没关系。"></node><node CREATED="1620678336249" ID="ID_01fbe9bfbfea" MODIFIED="1620678336249"></node><node CREATED="1620678336249" ID="ID_ce4941aab671" MODIFIED="1620678336249" TEXT="分析样例 美国失业率：https://www.math.pku.edu.cn/teachers/lidf/course/fts/ftsnotes/html/_ftsnotes/fts-ltscases-unempl.html"></node></node><node CREATED="1620678336249" ID="ID_e2454e6a3ae4" POSITION="right" MODIFIED="1620678336249" TEXT="7. 异方差模型：自回归条件异方差模型 ARCH"><node CREATED="1620678336249" ID="ID_9e72058ffab1" MODIFIED="1620678336249" TEXT="对将波动率定义为条件标准差，解决了传统的计量经济学对时间序列变量的第二个假设（變異數恆定）所引起的问题，ARCH模型能准确地模拟时间序列变量的波动性的变化。ARCH模型将当前一切可利用信息作为条件，并采用某种自回归形式来刻划方差的变异，对于一个时间序列而言，在不同时刻可利用的信息不同，而相应的条件方差也不同，利用ARCH&amp;nbsp;模型，可以刻划出随时间而变异的条件方差。"></node><node CREATED="1620678336249" ID="ID_103f0f9b54fc" MODIFIED="1620678336249" TEXT="金融时间序列的波动率特性&amp;lt;br&amp;gt;（1）存在波动率聚集现象。&amp;nbsp;即波动率在一段时间上高，一段时间上低。&amp;lt;br&amp;gt;（2）波动率以连续时间变化，很少发生跳跃&amp;lt;br&amp;gt;（3）波动率不会发散到无穷，波动率往往是平稳的&amp;lt;br&amp;gt;（4）波动率对价格大幅上升和大幅下降的反应是不同的，这个现象为杠杆效应&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;"></node><node CREATED="1620678336249" ID="ID_706a1aff3007" MODIFIED="1620678336249" TEXT="步骤（1）：通过检验数据的序列关性建立一个均值方程，如有必要，对收益率序列建立一个计量经济模型（如ARMA）来消除任何线形依赖。&amp;lt;br&amp;gt;步骤（2）：对均值方程的残差进行ARCH效应检验&amp;lt;br&amp;gt;步骤（3）：如果具有ARCH效应，则建立波动率模型&amp;lt;br&amp;gt;步骤（4）：检验拟合的模型，如有必要则进行改进"></node></node><node CREATED="1620678336249" ID="ID_bb779816d6a8" POSITION="right" MODIFIED="1620678336249" TEXT="8. GARCH,EGARCH,IGARCH,GARCH-M"><node CREATED="1620678336249" ID="ID_c754c145e4d1" MODIFIED="1620678336249" TEXT="GARCH模型允许方差随时间变化"></node></node><node CREATED="1620678336249" ID="ID_b7638ea600e1" POSITION="right" MODIFIED="1620678336249" TEXT="9. 多维平稳序列"></node><node CREATED="1620678336249" ID="ID_de0d9b81e455" POSITION="right" MODIFIED="1620678336249" TEXT="10. 非线性模型：门限自回归，状态相依模型，马尔可夫转移模型"></node></node></map>